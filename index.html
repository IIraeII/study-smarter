<!DOCTYPE html>
<html lang="en">

<head>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Pacifico&family=Patrick+Hand&display=swap"
        rel="stylesheet">
    <title>Spaced Repetition: The Interactive Comic</title>

    <link rel="stylesheet" href="style.css?v=2">
<link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß†</text></svg>">
</head>
</head>

<body>
    <!-- Toggle Button -->
    <button id="themeToggle" class="dark-mode-toggle" onclick="toggleTheme()" aria-label="Toggle Dark Mode">
        üåô
    </button>

    <header class="active-section" id="introduction" style="min-height: auto;">

        <!-- HERO BACKGROUND WRAPPER -->
        <div class="header-hero-bg">
            <div class="section-container" style="min-height:auto; padding:0; background:transparent;">
                <h1 class="fade-in delay-1" style="font-size: 4.5em; line-height: 1.1;">
                    <span class="headline-passive">Passive Learning Doesn't Stick...</span>
                    <span class="headline-active">
                        Active Recall Does
                        <!-- Simple Brain Icon SVG -->
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            style="color:var(--text-color); transform: rotate(15deg) translateY(-5px); opacity:0.7;">
                            <path
                                d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 4.44-4A2.5 2.5 0 0 1 9.5 2Z" />
                            <path
                                d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-4.44-4A2.5 2.5 0 0 0 14.5 2Z" />
                        </svg>
                    </span>
                </h1>

                <p class="subtitle fade-in delay-2">How one simple change can 10x your learning speed.</p>

                <p class="fade-in delay-3 author-tag" style="margin-top: 30px; font-size: 0.9em; opacity: 0.7;">
                    by <strong>R.</strong> ‚Ä¢ 2025 ‚Ä¢ ‚è±Ô∏è 8 min read
                </p>
            </div>
        </div>

        <!-- STORY CONTENT (White Background) -->
        <div class="section-container" style="min-height: auto; padding-top: 40px; padding-bottom: 20px;">
            <div class="story-content fade-in delay-2"
                style="text-align: left; margin: 20px auto; max-width: 600px; font-size: 1.05em; line-height: 1.8;">
                <p>
                    If you‚Äôve ever <strong>reread the same notes five times</strong> and still blanked on the exam,
                    you‚Äôre
                    not alone.
                    <br>
                    Across higher education‚Äîespecially in <strong>demanding science, health, and technical
                        majors</strong>‚Äîstudents spend hours studying but still feel like nothing is sticking.
                </p>
                <p>
                    What most of us never learned is that <em>the way you study</em> matters more than <em>how long you
                        study</em>.
                    Research has shown that the most effective learning strategies are the ones that students
                    <strong>rarely
                        use</strong>.
                </p>
                <p>
                    Popular methods like <strong>rereading, highlighting, and cramming</strong> aren‚Äôt effective for
                    long-term memory.
                    <br>
                    Based on research from cognitive psychology, here is the truth:
                </p>

                <div class="secret-container fade-in delay-2">
                    <div class="secret-box">
                        <div class="secret-text-content">
                            <h3 style="margin-top:0; color:#4f46e5;">üí° The Secret:</h3>
                            <p>
                                Retrieval practice and spaced repetition produce <strong>far more durable, transferable
                                    learning</strong>.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="checklist-container fade-in delay-3">
            <h3 style="font-size:2em; margin-bottom:20px; color:#555; text-align:center;">
                ‚ùì Do any of these sound like you?
            </h3>
            <div class="checklist-items">
                <label class="custom-checkbox">
                    <input type="checkbox" onchange="checkStatus()">
                    <span class="checkmark"></span>
                    I cram the night before exams üìö
                </label>

                <label class="custom-checkbox">
                    <input type="checkbox" onchange="checkStatus()">
                    <span class="checkmark"></span>
                    I read the textbook but forget it instantly üß†
                </label>

                <label class="custom-checkbox">
                    <input type="checkbox" onchange="checkStatus()">
                    <span class="checkmark"></span>
                    I feel overwhelmed by how much there is to learn üìù
                </label>
            </div>

            <div style="text-align:center;">
                <button id="diagnosis-btn" class="diagnosis-btn hidden-btn" onclick="revealSolution()">
                    See the Cure ‚ûú
                </button>
            </div>
        </div>

        <div id="solution-reveal" class="hidden-content">
            <div class="highlight-box">
                <h3>The Answer: Spaced Repetition</h3>
                <p>It's not magic. It's the biology of how your brain actually works.</p>

                <div class="diagram-placeholder" style="border:none; background:transparent;">
                    <img src="forgetting_curve_diagram.jpeg" alt="Forgetting Curve Diagram"
                        style="width:100%; border-radius:8px; box-shadow:0 4px 6px rgba(0,0,0,0.1);">
                </div>
            </div>
        </div>
    </header>
    <section class="section-container" id="my-story" style="min-height: auto; padding-top: 20px; padding-bottom: 20px;">

        <div class="story-content" style="max-width: 800px; margin: 0 auto;">
            <div class="quote-box story-quote">
                <p>
                    <strong>I learned this first-hand.</strong> When I first tried spaced repetition, I felt that it was
                    a <em>waste of time</em>! ‚è≥
                    I thought that there was no way looking over cards is going to help me be a better student‚Äîit just
                    did not feel productive!
                    I was used to writing pages and pages of notes, so not needing any papers, pens, or highlighters
                    felt so foreign to me. üìù
                </p>
                <p>
                    After being convinced by my friends many times about using spaced repetition (specifically
                    <strong>Anki</strong>), I came back to it with <strong>simpler cards</strong>, <strong>shorter
                        sessions</strong>, and <strong>real retrieval-based questions</strong>.
                </p>
                <p>
                    This is when <em>everything changed</em>. ‚ú® Concepts that used to slip out of my mind suddenly
                    started sticking. üß©
                    I remembered small details weeks later without having to cram, and my confidence going into exams
                    was higher.
                    The difference wasn‚Äôt more effort‚Äîit was just <strong>better strategy</strong>.
                </p>
            </div>
        </div>

    </section>


    <main class="section-container" id="retrieval-practice">
        <p class="transition-text fade-in" style="margin-bottom: 20px; font-style: italic; color: #666;">
            So if passive review is an illusion, what actually works?
        </p>

        <h2>üß† <strong>Retrieval Practice</strong> Works Better</h2>

        <div style="text-align: left; max-width: 700px; margin-bottom: 30px;">
            <p>
                Retrieval practice is simple: try to recall what you are learning from memory instead of rereading it.
                Flashcards, practice quizzes, and explaining concepts to a friend all count as forms of active
                retrieval.
            </p>
            <p>
                The message is clear: <strong>re-reading feels productive, but retrieving creates learning.</strong>
                When you force yourself to recall, you can actually gauge whether you know the information or not.
            </p>
            <p>
                Research confirms this. A study published in <strong>Science <a href="#references"
                        style="color:var(--accent-color); text-decoration:none;">(Karpicke & Blunt, 2011)</a></strong>
                showed that students who tested themselves significantly outperformed those who just read conceptual
                maps, even when spending the same amount of time. Further research <strong>(Xu et al., 2024)</strong>
                links these active recall strategies to higher GPAs and better exam performance.
            </p>
        </div>

        <div class="comparison-container">
            <div class="concept-box passive">
                <h3>üö´ Passive Review</h3>
                <p>Rereading & Highlighting. Creates the "illusion of competence"‚Äîyou recognize it, but can't use it.
                </p>
            </div>

            <div class="concept-box active">
                <h3>‚úÖ Active Retrieval</h3>
                <p>Testing yourself. It feels harder, but that struggle is what strengthens the memory.</p>
            </div>
        </div>

        <p class="instruction-text">Test the difference right now. <strong>Click to flip!</strong> ‚§µÔ∏è</p>

        <div class="flashcard-scene">
            <div class="flashcard-object" onclick="this.classList.toggle('flipped')">
                <div class="face front">
                    <p>What is the "illusion of competence"?</p>
                </div>
                <div class="face back">
                    <p>Thinking you know material just because you recognize it while reading.</p>
                </div>
            </div>
        </div>

    </main>
    <section class="section-container" id="force-multiplier">
        <p class="transition-text fade-in" style="margin-bottom: 20px; font-style: italic; color: #666;">
            Retrieving it once proves you know it <em>now</em>. But how do you keep knowing it?
        </p>

        <h2>üöÄ <strong>Spaced Repetition</strong> Is a Force Multiplier</h2>

        <!-- Replaced content-split with simple block flow since evidence box removed -->
        <div style="text-align: left; margin: 0 auto;">
            <p>
                Retrieving information once isn‚Äôt enough. The real gains happen when you <strong>space out your
                    review sessions</strong> over several days and weeks, rather than cramming them in one sitting.
            </p>
            <p>
                Research supports this powerful effect. A meta-analysis in <strong>JMIR (Martinengo et al.,
                    2024)</strong> found that spaced digital learning improved knowledge retention and clinical skills
                more than massed learning. Similarly, <strong>Durrani et al. (2024)</strong> found that medical students
                using spaced flashcards significantly outperformed their peers after only four weeks.
            </p>
            <p>
                Spacing works because it takes advantage of the <strong>Ebbinghaus Forgetting Curve</strong>.
                After you learn something, your brain begins to forget it almost immediately.
                Without reinforcement, retention drops sharply within hours.
            </p>

            <!-- NEW EBBINGHAUS BIO SECTION -->
            <div class="bio-box"
                style="background: rgba(0,0,0,0.03); padding: 25px; border-radius: 12px; margin: 30px 0; border-left: 4px solid var(--accent-color);">
                <div style="display:flex; gap:20px; align-items:center; justify-content:center; margin-bottom:20px;">
                    <!-- Local Image Asset -->
                    <img src="ebbinghaus.jpg" alt="Hermann Ebbinghaus"
                        style="width:80px; height:80px; border-radius:50%; object-fit:cover; border:3px solid var(--bg-color); box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <div style="text-align: left;">
                        <h4 style="margin:0 0 5px 0; font-size:1.2em;">Hermann Ebbinghaus</h4>
                        <span style="font-size:0.9em; color:#666; font-style:italic;">The Psychologist Who Memorized
                            "Nonsense" (1885)</span>
                    </div>
                </div>

                <p style="font-size:1em; margin-bottom:15px;">
                    German psychologist Hermann Ebbinghaus wanted to understand <strong>pure memory</strong>.
                    To remove variables like "meaning" or "association," he spent years memorizing thousands of
                    <strong>nonsense syllables</strong> (like "WID", "ZOF", "KAF") and testing his recall.
                </p>

                <div
                    style="background:var(--bg-color); padding:15px; border-radius:8px; margin-bottom:15px; border:1px solid rgba(0,0,0,0.1);">
                    <strong style="display:block; margin-bottom:10px; color:var(--accent-color);">üìâ The
                        "Forgetting" Stats:</strong>
                    <ul style="margin:0; padding-left:20px; font-size:0.95em; margin-bottom:15px;">
                        <li>After <strong>20 minutes</strong>, he forgot ~40% of the list.</li>
                        <li>After <strong>1 day</strong>, he forgot ~66%.</li>
                        <li>After <strong>6 days</strong>, he retained less than 25%.</li>
                    </ul>
                    <!-- Curve Diagram -->
                    <img src="forgetting_curve.png" alt="Ebbinghaus Forgetting Curve Diagram"
                        style="width:100%; height:auto; border-radius:6px; border:1px solid #eee;">
                    <p style="font-size:0.8em; color:#666; text-align:center; margin-top:5px;">
                        <em>Notice the steep drop? That's your brain deleting "useless" data.</em>
                    </p>
                </div>

                <p style="font-size:1em;">
                    <strong>Why does this happen?</strong> <br>
                    Your brain is an efficiency machine. It views unused information as "spam" and clears the cache
                    to save energy.
                    If you don't retrieve it, your brain assumes it's not important for survival.
                </p>

                <p style="font-size:1em; margin-top:15px; border-top:1px dashed #ccc; padding-top:15px;">
                    <strong>üí° The Silver Lining: "Savings"</strong><br>
                    Ebbinghaus discovered something encouraging: even when you "forget" a list, relearning it takes a
                    fraction of the original time. This <strong>"Savings Effect"</strong> proves the memory isn't
                    gone‚Äîjust buried. Spaced repetition works by digging these memories up right before they completely
                    fade, strengthening them each time.
                </p>
            </div>

            <p>
                But if you revisit the material <em>just</em> as you are starting to forget it, this act of
                retrieval strengthens your memory and halts the decay.
            </p>
        </div>

        <div class="tool-shoutout" style="margin-top: 20px;">
            <h3>üõ†Ô∏è Putting it into Practice</h3>
            <p>
                This is especially helpful with flashcard apps such as <strong>Anki</strong> that utilize an algorithm
                to perfectly space your reviews.
                Instead of fighting the forgetting curve, spaced repetition works <em>with</em> it, turning forgetting
                into a tool for deeper learning.
            </p>
            <div class="simulation-box">
                <h4>üìâ The Forgetting Curve</h4>
                <div style="display:flex; align-items:center; justify-content:center;">
                    <!-- Y-Axis Label -->
                    <div
                        style="writing-mode: vertical-rl; transform: rotate(180deg); font-size: 0.8em; color: #888; font-weight: bold; margin-right: 10px;">
                        Retention %
                    </div>
                    <div>
                        <canvas id="forgettingCurveCanvas" width="400" height="250"></canvas>
                        <!-- X-Axis Label -->
                        <div
                            style="text-align: center; font-size: 0.8em; color: #888; font-weight: bold; margin-top: 0px;">
                            Time ‚Üí
                        </div>
                    </div>
                </div>

                <div class="controls-area">
                    <label for="decaySlider"><strong>Decay Rate:</strong></label>
                    <input type="range" id="decaySlider" min="0" max="100" value="50">
                </div>

                <p id="curveCaption" class="caption-text">
                    Higher decay = Faster forgetting üìâ
                </p>
            </div>

            <div class="simulation-box" style="margin-top: 30px;">
                <h4>üçØ The Sweet Spot</h4>
                <p style="font-size: 0.9em; margin-bottom: 10px;">
                    What if you review <em>only</em> when you hit the "Sweet Spot"? See how the gaps naturally widen!
                </p>

                <div style="display:flex; align-items:center; justify-content:center;">
                    <!-- Y-Axis Label -->
                    <div
                        style="writing-mode: vertical-rl; transform: rotate(180deg); font-size: 0.8em; color: #888; font-weight: bold; margin-right: 10px;">
                        Retention %
                    </div>
                    <div>
                        <canvas id="sweetSpotCanvas" width="400" height="250"></canvas>
                        <!-- X-Axis Label -->
                        <div
                            style="text-align: center; font-size: 0.8em; color: #888; font-weight: bold; margin-top: 0px;">
                            Time (Repeated Review) ‚Üí
                        </div>
                    </div>
                </div>

                <div class="controls-area">
                    <label for="sweetSpotSlider"><strong>Sweet Spot:</strong></label>
                    <input type="range" id="sweetSpotSlider" class="slider-yellow" min="50" max="95" value="80">
                </div>

                <div class="badge-container"
                    style="display:flex; justify-content:center; gap:10px; align-items:center; margin-bottom:10px;">
                    <label><strong>Timing:</strong></label>
                    <span
                        style="background:#dbeafe; color:#2563eb; padding:2px 8px; border-radius:12px; font-size:0.8em; font-weight:bold;">
                        ‚úÖ Auto-optimize!
                    </span>
                </div>

                <div class="controls-area">
                    <label for="initialDecaySlider"><strong>Difficulty:</strong></label>
                    <input type="range" id="initialDecaySlider" min="10" max="100" value="50">
                </div>

                <p id="sweetSpotCaption" class="caption-text">
                    Reviewing at 80% recall -> Stronger Memory! üöÄ
                </p>
            </div>
        </div>

    </section>
    <!-- END OF SECTION B -->

    <section class="section-container" id="feedback-loops">
        <p class="transition-text fade-in" style="margin-bottom: 20px; font-style: italic; color: #666;">
            Timing is crucial, but it's not the only factor. The <em>quality</em> of your questions matters just as
            much.
        </p>
        <h2>üîÑ <strong>Feedback</strong> and High-Quality Questions Matter</h2>
        <div style="text-align: left; max-width: 700px; margin-bottom: 20px;">
            <p>
                Retrieval is only powerful if the questions make you actually think! Low-level questions like "Define X"
                don't promote deep learning.
                High-quality questions like "How does X cause Y?" or "What happens if...?" build flexible understanding.
            </p>
            <p>
                In fact, a JMIR meta-analysis found that <strong>immediate explanatory feedback</strong> dramatically
                increases the effect of spaced learning. Without feedback, you might just be practicing the wrong
                answers.
            </p>
        </div>

        <div class="quote-box">
            <p>
                "Students benefit most when cards force them to explain concepts, not memorize definitions... Feedback
                transforms flashcards from memorization tools into understanding tools."
                <br>
                <strong>‚Äî Ali Abdaal, Productivity Educator</strong>
            </p>
        </div>

        <div class="key-takeaway">
            <h4>üìù How to make better cards:</h4>
            <ul>
                <li><strong>Ask Why/How:</strong> Connect concepts instead of isolating them.</li>
                <li><strong>Mini Explanations:</strong> Add short context to your answers (not just one word).</li>
                <li><strong>Binary Feedback:</strong> You either know it or you don't. No "sort of".</li>
            </ul>
        </div>

        <div class="card-doctor-container">
            <h3>üöë The Card Doctor</h3>
            <p>Why most people fail: <strong>Bad Cards.</strong></p>

            <div class="card-comparison">
                <!-- Bad Card (Passive) -->
                <div id="bad-card-demo" class="bad-card">
                    <h4>Q: Mitochondria Function</h4>
                    <p style="color:#555;">A: Powerhouse of the cell, found in cytoplasm, double membrane... (too much
                        info)</p>
                </div>

                <!-- Good Cards (Active) -->
                <div id="good-cards-demo" class="good-cards-container hidden">
                    <div class="good-card">
                        <h4>Q: Function of Mitochondria?</h4>
                        <p>A: Generates most of the cell's supply of ATP (energy).</p>
                    </div>
                    <div class="good-card">
                        <h4>Q: What cells lack them?</h4>
                        <p>A: Mature red blood cells.</p>
                    </div>
                </div>
            </div>

            <button id="fix-card-btn" class="fix-btn" onclick="fixCard()">
                Fix This Card ü™Ñ
            </button>

            <p id="fix-feedback" class="caption-text hidden">
                Much better! <strong>Atomic cards</strong> = Binary feedback (Right/Wrong).

    </section>

    <!-- NEW SECTION: WIDE DEMOS -->
    <section class="section-container wide-section" id="action-demos">
        <p class="transition-text fade-in"
            style="margin-bottom: 40px; text-align: center; font-style: italic; color: #666;">
            We've covered the science. Now, let's look at the tools that automate this entire process for you.
        </p>
        <div style="margin-bottom: 40px; text-align: center;">
            <h2>See It in Action</h2>
        </div>

        <div class="demos-wrapper">

            <!-- ROW 1: ANKI DEMO + EXPLANATION -->
            <div class="demo-feature-row">
                <!-- ANKI SIMULATOR -->
                <div class="anki-demo-container">
                    <h4 style="margin-bottom: 20px;">A Normal Anki Review</h4>
                    <div class="anki-card-frame">
                        <div class="anki-top-bar">
                            <span id="anki-counter"><span style="color:#5dade2">10</span> <span
                                    style="color:#e74c3c">5</span>
                                <span style="color:#2ecc71">0</span></span>
                        </div>
                        <div class="anki-q-area">
                            <h3 id="anki-q" style="color:var(--text-color)">What is the capital of Brazil?</h3>
                            <div id="anki-flag" class="anki-flag">üáßüá∑</div> <!-- Emulator Flag -->
                        </div>

                        <div id="anki-answer-area" class="hidden">
                            <hr class="anki-divider">
                            <h3 id="anki-a" style="color:var(--text-color)">Bras√≠lia</h3>
                        </div>

                        <div class="anki-footer-area">
                            <button id="anki-show-btn" class="anki-action-btn" onclick="showAnkiAnswer()">Show
                                Answer</button>

                            <div id="anki-rate-btns" class="anki-grid-btns hidden">
                                <div class="anki-btn-group">
                                    <span class="anki-time">&lt;1m</span>
                                    <button class="anki-rate-btn btn-again"
                                        onclick="rateAnkiCard('again')">Again</button>
                                </div>
                                <div class="anki-btn-group">
                                    <span class="anki-time">&lt;6m</span>
                                    <button class="anki-rate-btn btn-hard" onclick="rateAnkiCard('hard')">Hard</button>
                                </div>
                                <div class="anki-btn-group">
                                    <span class="anki-time">10m</span>
                                    <button class="anki-rate-btn btn-good" onclick="rateAnkiCard('good')">Good</button>
                                </div>
                                <div class="anki-btn-group">
                                    <span class="anki-time">4d</span>
                                    <button class="anki-rate-btn btn-easy" onclick="rateAnkiCard('easy')">Easy</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- EXPLANATION TEXT RIGHT -->
                <div class="demo-text">
                    <h3>How It Works</h3>
                    <p>
                        This isn't just a flashcard; it's a <strong>scheduling engine</strong>.
                    </p>
                    <ul style="padding-left: 20px; line-height: 1.6;">
                        <li><strong>Active Recall:</strong> You must retrieve the answer <em>before</em> flipping. No
                            cheating!</li>
                        <li><strong>Honest Rating:</strong> You tell the algorithm how hard it was (Again, Hard, Good,
                            Easy).</li>
                        <li><strong>Smart Scheduling:</strong>
                            <br>üî¥ <strong>Again:</strong> See it in < 1 min (Relearning). <br>üü¢ <strong>Good:</strong>
                                See it in 10 mins (Graduating).
                                <br>üîµ <strong>Easy:</strong> See it in 4 days (Review).
                        </li>
                    </ul>
                    <p><em>The result? You only study what you're about to forget.</em></p>
                </div>
            </div>

            <!-- ROW 2: ANKIMON DEMO + EXPLANATION -->
            <div class="demo-feature-row">
                <!-- ANKIMON SIMULATOR -->
                <div class="ankimon-battle-container">
                    <h4 style="margin-bottom: 20px; text-align:center; color:white;">Ankimon Battles While You Study
                    </h4>
                    <div class="battle-scene">
                        <div class="battle-hud enemy-hud">
                            <div style="font-weight:bold;">Dratini <span style="font-size:0.8em; color:#ccc;">Lvl
                                    12</span></div>
                            <div class="hp-bar-wrap">
                                <div class="hp-fill" id="enemy-hp" style="width:100%"></div>
                            </div>
                        </div>
                        <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/147.png"
                            class="sprite enemy-sprite pixel-art" id="enemy-sprite">
                        <div class="battle-hud player-hud">
                            <div style="font-weight:bold;">Squirtle <span style="font-size:0.8em; color:#ccc;">Lvl
                                    15</span></div>
                            <div class="hp-bar-wrap">
                                <div class="hp-fill" id="player-hp" style="width:100%"></div>
                            </div>
                            <div class="xp-bar-wrap-mini">
                                <div class="xp-fill-blue" id="player-xp-mini" style="width:40%"></div>
                            </div>
                        </div>
                        <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/back/7.png"
                            class="sprite player-sprite pixel-art" id="player-sprite">
                    </div>
                    <div class="battle-dialogue" id="battle-text">
                        Wild Dratini appeared!
                    </div>
                    <div class="ankimon-review-area">
                        <div id="battle-q">
                            <h4 style="margin:0 0 10px 0;">Biology: Cell Structure</h4>
                            <p style="font-size:1.1em; margin-bottom:15px;">Powerhouse of the cell?</p>
                            <button id="battle-show-btn" class="anki-action-btn" onclick="battleShowAnswer()">Show
                                Answer</button>
                        </div>
                        <div id="battle-a" class="hidden">
                            <h4 style="color:var(--accent-color); margin:0 0 10px 0;">Mitochondria</h4>
                            <div class="battle-actions-grid">
                                <button class="battle-btn btn-again" onclick="battleMove('Again')">Again</button>
                                <button class="battle-btn btn-hard" onclick="battleMove('Hard')">Hard</button>
                                <button class="battle-btn btn-good" onclick="battleMove('Good')">Good</button>
                                <button class="battle-btn btn-easy" onclick="battleMove('Easy')">Easy</button>
                            </div>
                        </div>
                        <div id="battle-win" class="hidden">
                            <h3 style="color:#2ecc71; margin-top:0;">Enemy Fainted!</h3>
                            <div style="display:flex; gap:10px; margin-top:10px;">
                                <button class="catch-btn" style="background:#ff5252;" onclick="battleCatch()">üî¥
                                    Catch</button>
                                <button class="catch-btn" style="background:#3498db;" onclick="battleNext()">‚öîÔ∏è Defeat
                                    (+XP)</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- EXPLANATION TEXT RIGHT -->
                <div class="demo-text">
                    <h3>Gamify Your Learning</h3>
                    <p>
                        Let's be honest: studying can be boring. üò¥
                        <br>
                        <strong>Gamification</strong> solves this by adding immediate rewards to the long-term process.
                    </p>
                    <ul style="padding-left: 20px; line-height: 1.6;">
                        <li><strong>Turn-Based Combat:</strong> Your flashcards become ammo. Answer correctly to attack!
                        </li>
                        <li><strong>Visual Progress:</strong> Seeing XP bars fill up releases dopamine, making you
                            <em>want</em> to
                            do one more card.
                        </li>
                        <li><strong>Add-ons:</strong> This is real! Tools like <a
                                href="https://ankiweb.net/shared/info/1908235722" target="_blank"
                                style="color:var(--accent-color); text-decoration:none;"><em>Ankimon</em></a>
                            plug directly into Anki.</li>
                    </ul>
                    <p><em>Turn the "grind" into a game.</em> üéÆ</p>
                </div>
            </div>

        </div>
    </section>



    <!-- SECTION D: MOTIVATION -->
    <section class="section-container" id="motivation">
        <h2>üî• <strong>Motivation</strong> and Friction</h2>

        <div style="text-align: left; max-width: 700px; margin-bottom: 20px;">
            <p>
                Finally, knowing that retrieval works doesn‚Äôt automatically mean students use it. The real challenge
                is motivation and sustainability.
                How can one stick with using this study method to maximize efficiency?
            </p>
            <div class="bio-box"
                style="border-left: 4px solid #F59E0B; background: rgba(245, 158, 11, 0.05); padding: 15px; border-radius: 8px; margin: 20px 0;">
                <p style="margin:0;">
                    <strong>Productivity Expert Thomas Frank</strong> (2.9M+ subscribers) argues that relying on
                    willpower is a trap.
                    Instead, he focuses on <strong>"Activation Energy"</strong>‚Äîthe effort required to
                    <em>start</em> a task.
                </p>
                <p style="margin-top:10px; font-size:0.95em;">
                    If your flashcards are buried in a backpack, the "energy cost" to start matches climbing a hill.
                    If they are on your phone's home screen, the cost is a single tap.
                    <em>You don't need more motivation; you need less friction.</em>
                </p>
            </div>
        </div>

        <!-- FRICTION AUDIT (NOTEBOOK STYLE) -->
        <div class="friction-calc-box">
            <h4 style="margin-top:0; font-size:1.5em; margin-bottom:10px;">üìä
                The Friction Audit</h4>
            <p style="font-size:0.9em; margin-bottom:15px; color:#555;">Check
                all the obstacles currently in your way:</p>

            <div class="friction-list">
                <label class="friction-item">
                    <span>üì± Phone is within arm's reach</span>
                    <input type="checkbox" onchange="calculateFriction()" value="30">
                </label>
                <label class="friction-item">
                    <span>üíª 20+ unrelated browser tabs open</span>
                    <input type="checkbox" onchange="calculateFriction()" value="20">
                </label>
                <label class="friction-item">
                    <span>üéí Materials are still in the bag</span>
                    <input type="checkbox" onchange="calculateFriction()" value="25">
                </label>
                <label class="friction-item">
                    <span>ü§î Not sure what exactly to study</span>
                    <input type="checkbox" onchange="calculateFriction()" value="25">
                </label>
            </div>

            <div class="friction-meter-container">
                <div id="frictionBar" class="friction-meter-fill" style="width: 0%; background: #2ecc71;"></div>
            </div>
            <p id="frictionResult" class="result-text" style="color:#2ecc71;">Activation Energy: Low ‚ö° Ready to
                start!</p>
        </div>

        <script>
            function calculateFriction() {
                const checks = document.querySelectorAll('.friction-item input:checked');
                let score = 0;
                checks.forEach(c => score += parseInt(c.value));

                const bar = document.getElementById('frictionBar');
                const text = document.getElementById('frictionResult');

                // Cap score at 100 for width
                const width = Math.min(score, 100);
                bar.style.width = width + '%';

                if (score < 30) {
                    bar.style.background = '#2ecc71'; // Green
                    text.innerText = "Activation Energy: Low ‚ö° (You'll start automatically)";
                    text.style.color = '#2ecc71';
                } else if (score < 60) {
                    bar.style.background = '#f1c40f'; // Yellow
                    text.innerText = "Activation Energy: Medium üöß (Requires willpower)";
                    text.style.color = '#f39c12';
                } else {
                    bar.style.background = '#e74c3c'; // Red
                    text.innerText = "Activation Energy: High üõë (Likely to procrastinate)";
                    text.style.color = '#e74c3c';
                }
            }
        </script>

        <p>
            Gamification helps shift this dynamic. <strong>Xu et al. (2021)</strong> found that features like badges
            and streaks help students move from relying on external rewards to building internal motivation and a
            sense of competence (`Self-Determination Theory`).
        </p>
        <p>
            <em>Tip:</em> Try add-ons like <strong>Ankimon</strong> (Pokemon-style companion) to
            make reviews
            addictive! üëæ
        </p>

    </section>

    <!-- SECTION: TOOLKIT (MOVED) -->
    <section class="section-container" id="toolkit-section">
        <h2>üß∞ Your Active Learning Toolkit</h2>
        <p style="max-width:600px; margin-bottom:30px;">
            Ready to stop rereading and start remembering? Here is everything you need to get started today.
        </p>

        <div class="comparison-container" style="gap:20px; flex-wrap:wrap;">
            <!-- CARD 1: ANKI -->
            <div class="concept-box active" style="flex:1; min-width:250px;">
                <h3>üì± Anki (Free)</h3>
                <p>The gold standard. Infinite customization, powerful algorithm.</p>
                <a href="https://apps.ankiweb.net/" target="_blank" class="quiz-btn"
                    style="display:inline-block; text-decoration:none; margin-top:10px;">Download Anki</a>
            </div>

            <!-- CARD 2: QUIZLET -->
            <div class="concept-box active" style="flex:1; min-width:250px;">
                <h3>üÉè Quizlet</h3>
                <p>User-friendly, great for getting started quickly.</p>
                <a href="https://quizlet.com/" target="_blank" class="quiz-btn"
                    style="display:inline-block; text-decoration:none; margin-top:10px;">Visit Quizlet</a>
            </div>
        </div>


    </section>

    <section class="section-container" id="conclusion" style="max-width: 800px; padding: 20px 20px 10px 20px;">
        <h2 style="font-family: 'Pacifico', cursive; font-size: 3em; margin-bottom: 20px; color: var(--text-color);">
            In Conclusion...</h2>

        <div style="text-align: left; font-size: 1.05em; line-height: 1.8; margin-bottom: 10px;">
            <p>
                Most students aren‚Äôt struggling because they‚Äôre ‚Äúbad at studying‚Äù‚Äîthey‚Äôre struggling because they
                were
                <em>never taught</em> how learning truly works. üß†
            </p>
            <p>
                The science is clear: <strong>rereading</strong> and <strong>highlighting</strong> feel productive,
                but
                they don‚Äôt create lasting understanding.
                Real learning happens when you <strong>retrieve information</strong>, <strong>space your
                    practice</strong>, <strong>ask better questions</strong>, and <strong>build routines</strong>
                that
                you can actually stick with. üöÄ
            </p>



            <p>
                That‚Äôs the power of using your brain the way it‚Äôs designed to learn.
                When you combine <strong>retrieval practice</strong>, <strong>spaced repetition</strong>,
                <strong>high-quality questions</strong>, and <strong>sustainable habits</strong>, studying becomes
                less
                about <em>grinding</em> and more about building <strong>long-term, durable knowledge</strong>.
            </p>
            <p>
                If your current study routine isn‚Äôt working, it‚Äôs not a personal failure‚Äîit‚Äôs a <strong>solvable
                    strategy problem</strong>.
                Shift how you learn, and you‚Äôll start to see results that stick. üåü
            </p>
        </div>


    </section>

    <div style="text-align:center; padding: 10px 40px;">
        <button class="quiz-btn" style="background:var(--secondary-accent); color:var(--bg-color); font-weight:bold;"
            onclick="alert('Link copied to clipboard! Share the knowledge! üöÄ')">
            üì≤ Share with a Friend
        </button>
    </div>

    <!-- REFERENCES SECTION -->
    <section class="references-section" id="references">
        <div style="max-width: 800px; margin: 0 auto;">
            <h3>üìö References & Further Reading</h3>
            <ul class="references-list">
                <li><strong>Karpicke, J. D., & Blunt, J. R.</strong> (2011). Retrieval practice produces more
                    learning
                    than elaborate studying with concept mapping. <em>Science</em>, 331(6018), 772-775.</li>
                <li><strong>Xu, J., et al.</strong> (2024). The impact of active recall and spaced repetition on
                    student
                    performance. <em>Journal of Affective Disorders</em>.</li>
                <li><strong>Martinengo, L., et al.</strong> (2024). Spaced digital learning for health
                    professionals: A
                    meta-analysis. <em>Journal of Medical Internet Research</em>.</li>
                <li><strong>Durrani, N., et al.</strong> (2024). Effect of spaced repetition on retention of medical
                    knowledge. <em>BMC Medical Education</em>.</li>
                <li><strong>Gilbert, S., et al.</strong> (2023). Best practices in learning science for medical
                    education. <em>Medical Science Educator</em>.</li>
                <li><strong>Frank, T.</strong> (2021). "The Most Powerful Way to Remember What You Study".
                    <em>Thomas
                        Frank / College Info Geek</em>.
                </li>
                <li><strong>Abdaal, A.</strong> (2022). "Why Active Recall Works". <em>Ali Abdaal Blog</em>.</li>
            </ul>
        </div>
    </section>

    <div style="text-align:center; padding-bottom: 40px; margin-top: 20px;">
        <button class="quiz-btn"
            style="background: var(--accent-color); color: var(--bg-color); padding: 15px 30px; font-weight:bold; border:none;"
            onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
            Scroll to Top <span class="bounce-arrow">‚¨ÜÔ∏è</span>
        </button>
    </div>

    <script>
        // ==========================================
        // 1. GLOBAL SETTINGS & OBSERVERS
        // ==========================================

        // --- Scroll Animation Observer ---
        const observerOptions = { threshold: 0.3 };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('active');
            });
        }, observerOptions);

        // ==========================================
        // 2. APP LOGIC (Functions)
        // ==========================================

        // --- A. Graph Drawing Logic (Section B) ---
        function initGraph() {
            const canvas = document.getElementById('forgettingCurveCanvas');
            const slider = document.getElementById('decaySlider');
            const caption = document.getElementById('curveCaption');

            if (!canvas || !slider) return; // Guard clause

            const ctx = canvas.getContext('2d');

            function drawCurve() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const val = parseInt(slider.value);
                const decay = 0.005 + (val / 1000);

                ctx.beginPath();
                ctx.lineWidth = 5;
                ctx.strokeStyle = '#ff6b6b';
                ctx.lineCap = 'round';

                for (let x = 0; x < canvas.width; x++) {
                    const y = canvas.height * Math.exp(-decay * x);
                    ctx.lineTo(x, canvas.height - y); // Invert Y
                }
                ctx.stroke();

                // --- AXIS LABELS REMOVED (Moved to HTML) ---
                // ctx.fillStyle = "#888";
                // ctx.font = "12px sans-serif";
                // ctx.fillText("Retention %", 10, 20);
                // ctx.fillText("Time ‚Üí", canvas.width - 50, canvas.height - 10);

                if (caption) {
                    if (val < 30) caption.innerText = "Low Decay: Stays in memory! üß†";
                    else if (val > 70) caption.innerText = "High Decay: Forgotten fast! üìâ";
                    else caption.innerText = "Normal Decay: Needs spaced repetition. üõ†Ô∏è";
                }
            }


            slider.oninput = drawCurve;
            drawCurve(); // Initial draw
        }

        // --- B. Sweet Spot Simulation (Section B - Second Graph) ---
        function initSweetSpotGraph() {
            const canvas = document.getElementById('sweetSpotCanvas');
            const spotSlider = document.getElementById('sweetSpotSlider'); // Target %
            const decaySlider = document.getElementById('initialDecaySlider'); // Initial Difficulty
            const caption = document.getElementById('sweetSpotCaption');

            if (!canvas || !spotSlider || !decaySlider) return;

            const ctx = canvas.getContext('2d');

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Get User Values
                const targetPercent = parseInt(spotSlider.value);
                const initialDecay = 0.01 + (parseInt(decaySlider.value) / 1000);

                const w = canvas.width;
                const h = canvas.height - 40; // Reserve bottom 40px for Timeline
                const timelineY = canvas.height - 30;

                // Visualization Params
                let memory = 1.0;
                let currentDecay = initialDecay;
                let lastRecallX = 0;
                let ghostCurves = [];
                let recallPoints = []; // Store where we recalled for drawing dots/bars

                // 1. Draw "Sweet Spot" Zone
                const zoneY = h * (1 - (targetPercent / 100));
                const zoneHeight = h - zoneY;
                const gradient = ctx.createLinearGradient(0, zoneY, 0, h);
                gradient.addColorStop(0, "rgba(255, 215, 0, 0.3)");
                gradient.addColorStop(1, "rgba(255, 215, 0, 0.0)");
                ctx.fillStyle = gradient;
                ctx.fillRect(0, zoneY, w, zoneHeight);

                // Threshold Line
                ctx.beginPath();
                ctx.strokeStyle = "#f1c40f";
                ctx.setLineDash([5, 5]);
                ctx.moveTo(0, zoneY);
                ctx.lineTo(w, zoneY);
                ctx.stroke();
                ctx.setLineDash([]);

                // 2. Main Simulation Loop
                let points = [];

                for (let x = 0; x <= w; x++) {
                    let t = x - lastRecallX;
                    memory = Math.exp(-currentDecay * t);
                    let y = h - (h * memory);

                    points.push({ x, y });

                    // CHECK FOR RECALL
                    let memoryPercent = memory * 100;
                    if (memoryPercent <= targetPercent) {
                        // === RECALL EVENT ===

                        // Store ghost curve start
                        ghostCurves.push({
                            startX: x,
                            decay: currentDecay,
                            startMemory: memory
                        });

                        // Store Recall Point (for visual dots)
                        recallPoints.push({ x: x, y: y });

                        // Draw Spike
                        points.push({ x: x, y: 0 });

                        // Reset
                        lastRecallX = x;
                        memory = 1.0;

                        // Apply Spacing (Slower Decay)
                        currentDecay *= 0.5; // Optimized for clearer visual
                    }
                }

                // 3. Draw Main Curve
                ctx.beginPath();
                ctx.lineWidth = 4;
                ctx.strokeStyle = '#c0392b';
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                if (points.length > 0) ctx.moveTo(points[0].x, points[0].y);
                for (let p of points) ctx.lineTo(p.x, p.y);
                ctx.stroke();

                // 4. Draw Ghost Curves
                ctx.lineWidth = 1;
                ctx.strokeStyle = '#ddd';

                ghostCurves.forEach(ghost => {
                    ctx.beginPath();
                    for (let gx = ghost.startX; gx < w; gx++) {
                        let t = gx - ghost.startX;
                        let ghostMem = ghost.startMemory * Math.exp(-ghost.decay * t);
                        let gy = h - (h * ghostMem);
                        if (gx === ghost.startX) ctx.moveTo(gx, gy);
                        else ctx.lineTo(gx, gy);
                    }
                    ctx.stroke();
                });

                // 5. Draw Visual Extras (Dots & Bars)

                // Timeline Base
                ctx.beginPath();
                ctx.strokeStyle = "#eee";
                ctx.lineWidth = 1;
                ctx.moveTo(0, timelineY + 15);
                ctx.lineTo(w, timelineY + 15);
                ctx.stroke();

                recallPoints.forEach(p => {
                    // A. Yellow Dot at Curve
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 6, 0, 2 * Math.PI);
                    ctx.fillStyle = "#f1c40f";
                    ctx.fill();
                    ctx.strokeStyle = "white";
                    ctx.stroke();

                    // B. Pink Bar on Timeline
                    ctx.fillStyle = "#ffafaf"; // Soft Pink
                    ctx.fillRect(p.x - 4, timelineY, 8, 30); // Vertical pill
                });

                // Update Caption
                if (caption) {
                    caption.innerHTML = `Recall at <strong>${targetPercent}%</strong> = Gaps grow larger! üìè`;
                }

                // --- AXIS LABELS REMOVED (Moved to HTML) ---
                // ctx.fillStyle = "#888";
                // ctx.font = "12px sans-serif";
                // ctx.fillText("Retention %", 10, 20);
                // ctx.fillText("Time (Repeated Review) ‚Üí", canvas.width - 160, canvas.height - 10);
            }

            spotSlider.oninput = draw;
            decaySlider.oninput = draw;
            draw();
        }



        // --- C. Checklist/Quiz Logic (Intro) ---
        function checkStatus() {
            const checkboxes = document.querySelectorAll('.checklist-items input[type="checkbox"]');
            let isAnyChecked = Array.from(checkboxes).some(box => box.checked);

            const btn = document.getElementById('diagnosis-btn');
            if (btn) {
                if (isAnyChecked) {
                    btn.classList.add('visible-btn');
                    btn.classList.remove('hidden-btn');
                } else {
                    btn.classList.remove('visible-btn');
                    btn.classList.add('hidden-btn');
                }
            }
        }

        function revealSolution() {
            const solution = document.getElementById('solution-reveal');
            if (solution) {
                solution.style.display = 'block';
                solution.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // --- C. Card Doctor Logic (Section C) ---
        function fixCard() {
            const badCard = document.getElementById('bad-card-demo');
            const goodCards = document.getElementById('good-cards-demo');
            const btn = document.getElementById('fix-card-btn');
            const feedback = document.getElementById('fix-feedback');

            if (badCard && goodCards) {
                // 1. Hide Bad Card
                badCard.style.display = 'none';

                // 2. Show Good Cards
                goodCards.classList.remove('hidden');

                if (btn) btn.style.display = 'none'; // Hide button after use
                if (feedback) feedback.classList.remove('hidden');
            }
        }



        // --- G. Anki Simulator Logic ---
        const ankiDeck = [
            { q: "What is the capital of Brazil?", a: "Bras√≠lia", f: "üáßüá∑" },
            { q: "What is the capital of France?", a: "Paris", f: "üá´üá∑" },
            { q: "What is the capital of Japan?", a: "Tokyo", f: "üáØüáµ" },
            { q: "What is the capital of Egypt?", a: "Cairo", f: "üá™üá¨" },
            { q: "What is the capital of Australia?", a: "Canberra", f: "üá¶üá∫" }
        ];

        // "Virtual" queues to simulate a full deck state
        let ankiState = {
            blue: 15, // New
            red: 0,   // Learning
            green: 5  // Review
        };

        let currentCardType = 'blue'; // Track what 'queue' the current card came from

        function showAnkiAnswer() {
            document.getElementById('anki-answer-area').classList.remove('hidden');
            document.getElementById('anki-rate-btns').classList.remove('hidden');
            document.getElementById('anki-rate-btns').style.display = 'flex'; // Ensure flex
            document.getElementById('anki-show-btn').classList.add('hidden');
        }

        function rateAnkiCard(rating) {
            // 1. Apply Anki Logic to State
            if (currentCardType === 'blue') {
                // NEW CARD
                if (rating === 'again') {
                    ankiState.blue--;
                    ankiState.red++; // Failed new card -> Learning
                } else {
                    ankiState.blue--;
                    ankiState.green++; // Graduated -> Review (Simulated for flow)
                }
            } else if (currentCardType === 'red') {
                // LEARNING CARD
                if (rating === 'again') {
                    // Stays in red, no change
                } else {
                    ankiState.red--;
                    ankiState.green++; // Graduated -> Review
                }
            } else {
                // REVIEW CARD
                if (rating === 'again') {
                    ankiState.green--; // Removed from "Review Success" pile? Or stays? 
                    // Actually Anki: Failed Review -> Relearning (Red)
                    ankiState.green--; // No longer a "Review" for today
                    ankiState.red++;
                } else {
                    ankiState.green--; // Done for the day
                }
            }

            // prevent negatives (safety)
            if (ankiState.blue < 0) ankiState.blue = 0;
            if (ankiState.red < 0) ankiState.red = 0;
            if (ankiState.green < 0) ankiState.green = 0;

            // Check Empty
            if (ankiState.blue === 0 && ankiState.red === 0 && ankiState.green === 0) {
                // Reset Day
                ankiState = { blue: 12, red: 0, green: 8 };
                alert("All cards finished for today! ‚òÄÔ∏è\n(Resetting stats for demo...)");
            }

            nextAnkiCard();
        }

        function nextAnkiCard() {
            // 1. Reset UI
            document.getElementById('anki-answer-area').classList.add('hidden');
            document.getElementById('anki-show-btn').classList.remove('hidden');
            document.getElementById('anki-rate-btns').classList.add('hidden');

            // 2. Determine Next Card Type (Priority: Red > Green > Blue)
            if (ankiState.red > 0) currentCardType = 'red';
            else if (ankiState.green > 0) currentCardType = 'green';
            else currentCardType = 'blue';

            // 3. Pick Random Content (Flavor)
            const card = ankiDeck[Math.floor(Math.random() * ankiDeck.length)];
            document.getElementById('anki-q').innerText = card.q;
            document.getElementById('anki-a').innerText = card.a;
            document.getElementById('anki-flag').innerText = card.f;

            // 4. Update Header Numbers (Blue / Red / Green)
            const counterHTML = `
                <span style="color:#5dade2">${ankiState.blue}</span> 
                <span style="color:#e74c3c">${ankiState.red}</span> 
                <span style="color:#2ecc71">${ankiState.green}</span>
            `;
            document.getElementById('anki-counter').innerHTML = counterHTML;
        }

        // --- F. Dark Mode Logic ---
        function toggleTheme() {
            const body = document.body;
            const btn = document.getElementById('themeToggle');

            body.classList.toggle('dark-mode');

            // Update Icon
            if (body.classList.contains('dark-mode')) {
                btn.innerHTML = "‚òÄÔ∏è";
                // Optional: Force a redraw of canvas if needed, or just let it be. 
                // The canvas uses clearRect so it might need a redraw to pick up new background if transparent.
                // Our canvases are transparent, so they sit on top of bg-color. Should be fine.
            } else {
                btn.innerHTML = "üåô";
            }
        }



        // --- H. Ankimon Battle Logic ---
        let enemyHP = 100;
        let playerXP = 40;

        const battleDeck = [
            { q: "Powerhouse of the cell?", a: "Mitochondria" },
            { q: "Function of mitochondria?", a: "ATP production via cellular respiration." },
            { q: "Osmosis vs diffusion?", a: "Diffusion: High ‚Üí Low.<br>Osmosis: Water across membrane." },
            { q: "DNA base pairs?", a: "A‚ÄìT, C‚ÄìG." },
            { q: "Define homeostasis.", a: "Maintaining stable internal conditions." }
        ];

        // Copy deck for the session so we can remove used cards
        let currentSessionDeck = [...battleDeck];

        function battleShowAnswer() {
            // document.getElementById('battle-q').classList.add('hidden'); // NO HIDING Q
            document.getElementById('battle-show-btn').classList.add('hidden'); // Pick specific button ID
            document.getElementById('battle-a').classList.remove('hidden');
        }

        function battleMove(rating) {
            const dialogue = document.getElementById('battle-text');
            const enemySprite = document.getElementById('enemy-sprite');

            let damage = 0;
            let moveName = "Tackle";

            if (rating === 'Again') {
                dialogue.innerText = "Squirtle missed! (Review Again)";
                damage = 0;
            } else if (rating === 'Hard') {
                damage = 15;
                moveName = "Bubble";
                dialogue.innerText = `Squirtle used ${moveName}! It wasn't very effective...`;
            } else if (rating === 'Good') {
                damage = 40;
                moveName = "Water Gun";
                dialogue.innerText = `Squirtle used ${moveName}! It's super effective!`;
            } else if (rating === 'Easy') {
                damage = 100; // OHKO
                moveName = "Hydro Pump";
                dialogue.innerText = `Squirtle used ${moveName}! Critical Hit!`;
            }

            // Apply Damage
            if (damage > 0) {
                // Visuals
                enemySprite.style.animation = "damageFlash 0.5s";
                setTimeout(() => enemySprite.style.animation = "", 500);

                enemyHP -= damage;
                if (enemyHP < 0) enemyHP = 0;
                document.getElementById('enemy-hp').style.width = enemyHP + "%";
            }

            // Check Win or Continue
            if (enemyHP <= 0) {
                setTimeout(() => {
                    dialogue.innerText = "Wild Dratini fainted! What will you do?";
                    document.getElementById('battle-a').classList.add('hidden');
                    document.getElementById('battle-win').classList.remove('hidden');
                    enemySprite.style.opacity = "0.5"; // Fainted look
                }, 1000);
            } else {
                // Next Card (Loop)
                setTimeout(() => {
                    dialogue.innerText = "Next card loaded...";
                    resetBattleCard();
                }, 1500);
            }
        }

        function resetBattleCard() {
            document.getElementById('battle-q').classList.remove('hidden');
            document.getElementById('battle-show-btn').classList.remove('hidden'); // Show button again
            document.getElementById('battle-a').classList.add('hidden');

            // Refill if empty
            if (currentSessionDeck.length === 0) {
                currentSessionDeck = [...battleDeck];
                const dialogue = document.getElementById('battle-text');
                dialogue.innerText = "Deck Shuffled! üîÄ";
            }

            // Pick Random & Remove (Splice) to avoid repeats
            const randomIndex = Math.floor(Math.random() * currentSessionDeck.length);
            const card = currentSessionDeck[randomIndex];
            currentSessionDeck.splice(randomIndex, 1); // Remove from session deck

            document.querySelector('#battle-q p').innerHTML = card.q;
            document.querySelector('#battle-a h4').innerHTML = card.a;
        }

        function battleCatch() {
            const dialogue = document.getElementById('battle-text');
            dialogue.innerText = "Caught Dratini! Added to collection. üü¢";
            setTimeout(loadNewEnemy, 1500);
        }

        function battleNext() {
            const dialogue = document.getElementById('battle-text');
            playerXP += 20;
            if (playerXP > 100) playerXP = 10;
            document.getElementById('player-xp-mini').style.width = playerXP + "%";

            dialogue.innerText = "Squirtle gained 200 XP!";
            setTimeout(loadNewEnemy, 1500);
        }

        function loadNewEnemy() {
            enemyHP = 100;
            document.getElementById('enemy-hp').style.width = "100%";
            document.getElementById('enemy-sprite').style.opacity = "1";
            document.getElementById('battle-win').classList.add('hidden');
            resetBattleCard();
            document.getElementById('battle-text').innerText = "Wild Dratini appeared!";
        }

        // --- E. Intro Background Animation (Floating Cards) ---
        function initIntroAnimation() {
            // Target ONLY the hero background container
            const header = document.querySelector('.header-hero-bg');
            if (!header) return;

            // Updated Pastel Palette 
            const colors = ['#FFB7B2', '#B5EAD7', '#E2F0CB', '#FFDAC1', '#E0BBE4'];

            const numCards = 60; // Denser
            const cards = []; // Store references for animation loop

            for (let i = 0; i < numCards; i++) {
                // 1. Create Wrapper (Handles Float Animation)
                const wrapper = document.createElement('div');
                wrapper.classList.add('card-wrapper');

                // Random Size
                const width = Math.random() * 40 + 40;
                const height = width * 0.6;
                wrapper.style.width = `${width}px`;
                wrapper.style.height = `${height}px`;

                // Random Position
                const leftPos = Math.random() * 100;
                const topPos = Math.random() * 100;
                wrapper.style.left = `${leftPos}%`;
                wrapper.style.top = `${topPos}%`;

                // Wrapper Animation (Float Up)
                const duration = Math.random() * 20 + 15;
                const delay = Math.random() * 20;
                wrapper.style.animation = `floatUp ${duration}s linear infinite -${delay}s`;

                // 2. Create Inner Card (Visuals + Repulsion Transform)
                const card = document.createElement('div');
                card.classList.add('floating-card');

                // Styling
                const rawColor = colors[Math.floor(Math.random() * colors.length)];
                card.style.backgroundColor = rawColor;
                card.style.border = `1px solid rgba(0,0,0,0.05)`;
                card.style.opacity = '0.25'; // TRANSPARENT as requested (was 0.6)

                wrapper.appendChild(card);
                header.appendChild(wrapper);

                // Store center point relative to viewport for simplified physics?
                // Actually we will calculate relative to header container in the event loop.
                // We store the 'card' element to apply transform to.
                cards.push(card);
            }

            // --- MOUSE REPULSION RETURNED TO SIMPLE FLOATING ---
            // User requested to remove the interactive repulsion but keep the visuals.
            // So we just let the CSS animations do their thing!
        }

        // ==========================================
        // 3. INITIALIZATION
        // ==========================================
        // Force scroll to top on reload
        if (history.scrollRestoration) {
            history.scrollRestoration = 'manual';
        }

        window.onload = function () {
            console.log("App Loaded üöÄ");

            // 1. Attach Observers
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        // Also trigger fade-in children if any
                        const children = entry.target.querySelectorAll('.fade-in');
                        children.forEach(child => child.classList.add('visible'));
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.section-container').forEach(section => {
                observer.observe(section);
            });

            // FORCE TRIGGER INTRODUCTION (Fix for missing title)
            const intro = document.getElementById('introduction');
            if (intro) {
                intro.classList.add('visible');
                intro.querySelectorAll('.fade-in').forEach(el => el.classList.add('visible'));
            }

            // 2. Init Graphs & Sliders & Animation
            initGraph();
            initSweetSpotGraph();
            initIntroAnimation();

            // 3. Reset State (for reload freshness)
            window.scrollTo(0, 0);

            // Reset Checklist
            const checkboxes = document.querySelectorAll('.checklist-items input[type="checkbox"]');
            checkboxes.forEach(box => box.checked = false);

            // Reset Card Doctor
            const badCard = document.getElementById('bad-card-demo');
            if (badCard) badCard.style.display = 'block';

            const goodCards = document.getElementById('good-cards-demo');
            if (goodCards) goodCards.classList.add('hidden');

            const fixBtn = document.getElementById('fix-card-btn');
            if (fixBtn) fixBtn.style.display = 'inline-block';

            const fixFeedback = document.getElementById('fix-feedback');
            if (fixFeedback) fixFeedback.classList.add('hidden');
        };
    </script>
</body>

</html>
